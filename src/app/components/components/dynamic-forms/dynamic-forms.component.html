<md-card>
  <md-card-title>Dynamic Forms</md-card-title>
  <md-card-subtitle>Build forms from a JS object</md-card-subtitle>
  <md-divider></md-divider>
  <md-card-content>
    <h3 class="md-title">Dynamic Text Elements</h3>
    <md-divider></md-divider>
    <md-tab-group md-stretch-tabs>
      <md-tab>
        <ng-template md-tab-label>Demo</ng-template>
        <td-dynamic-forms [elements]="textElements">
        </td-dynamic-forms>
      </md-tab>
      <md-tab>
        <ng-template md-tab-label>Code</ng-template>
        <p>HTML:</p>
        <td-highlight lang="html">
          <![CDATA[
            <td-dynamic-forms [elements]="textElements">
            </td-dynamic-forms>
          ]]>
        </td-highlight>
        <p>Typescript:</p>
        <td-highlight lang="typescript">
          {{textElements | json}}
        </td-highlight>
      </md-tab>
    </md-tab-group>
  </md-card-content>
</md-card>
<md-card>
  <md-card-content>
    <h3 class="md-title">Dynamic Number Elements</h3>
    <md-divider></md-divider>
    <md-tab-group md-stretch-tabs>
      <md-tab>
        <ng-template md-tab-label>Demo</ng-template>
        <td-dynamic-forms [elements]="numberElements">
        </td-dynamic-forms>
      </md-tab>
      <md-tab>
        <ng-template md-tab-label>Code</ng-template>
        <p>HTML:</p>
        <td-highlight lang="html">
          <![CDATA[
            <td-dynamic-forms [elements]="numberElements">
            </td-dynamic-forms>
          ]]>
        </td-highlight>
        <p>Typescript:</p>
        <td-highlight lang="typescript">
          {{numberElements | json}}
        </td-highlight>
      </md-tab>
    </md-tab-group>
  </md-card-content>
</md-card>
<md-card>
  <md-card-content>
    <h3 class="md-title">Dynamic Boolean Elements</h3>
    <md-divider></md-divider>
    <md-tab-group md-stretch-tabs>
      <md-tab>
        <ng-template md-tab-label>Demo</ng-template>
        <td-dynamic-forms [elements]="booleanElements">
        </td-dynamic-forms>
      </md-tab>
      <md-tab>
        <ng-template md-tab-label>Code</ng-template>
        <p>HTML:</p>
        <td-highlight lang="html">
          <![CDATA[
            <td-dynamic-forms [elements]="booleanElements">
            </td-dynamic-forms>
          ]]>
        </td-highlight>
        <p>Typescript:</p>
        <td-highlight lang="typescript">
          {{booleanElements | json}}
        </td-highlight>
      </md-tab>
    </md-tab-group>
  </md-card-content>
</md-card>
<md-card>
  <md-card-content>
    <h3 class="md-title">Dynamic Array Elements</h3>
    <md-divider></md-divider>
    <md-tab-group md-stretch-tabs>
      <md-tab>
        <ng-template md-tab-label>Demo</ng-template>
        <td-dynamic-forms [elements]="arrayElements">
        </td-dynamic-forms>
      </md-tab>
      <md-tab>
        <ng-template md-tab-label>Code</ng-template>
        <p>HTML:</p>
        <td-highlight lang="html">
          <![CDATA[
            <td-dynamic-forms [elements]="arrayElements">
            </td-dynamic-forms>
          ]]>
        </td-highlight>
        <p>Typescript:</p>
        <td-highlight lang="typescript">
          {{arrayElements | json}}
        </td-highlight>
      </md-tab>
    </md-tab-group>
  </md-card-content>
</md-card>

<md-card>
  <md-card-content>
    <h3 class="md-title">Custom Validation</h3>
    <h4>Using Config with ITdCustomValidate</h4>
    <md-divider></md-divider>
    <md-tab-group md-stretch-tabs>
      <md-tab>
        <ng-template md-tab-label>Demo</ng-template>
        <td-dynamic-forms [elements]="customValidationITdCustomValidate">
        </td-dynamic-forms>
      </md-tab>
      <md-tab>
        <ng-template md-tab-label>Code</ng-template>
        <p>HTML:</p>
        <td-highlight lang="html">
          <![CDATA[
            <td-dynamic-forms [elements]="customValidationITdCustomValidate">
            </td-dynamic-forms>
          ]]>
        </td-highlight>
        <p>Typescript:</p>
        <td-highlight lang="typescript">
          <![CDATA[
              // Custom Validator using ITdCustomValidate object
              customValidationITdCustomValidate: ITdDynamicElementConfig[] = [{
                name: 'numberIsEven',
                label: 'Even Number In Rage',
                type: TdDynamicType.Number,
                customValidators: [

                  // Simple Validation using ITdCustomValidate interface
                  <ITdCustomValidate>{

                    // Must be unique
                    name: 'isEven',

                    // Static error message presented in UI
                    message: 'Must be even',

                    // Return true if valid
                    predicateFn: (value: any): boolean => {
                      return ( value % 2 ) === 0;
                    },
                  },
                ],
              }];
            ]]>
        </td-highlight>
      </md-tab>
    </md-tab-group>

    <h4>Using ValidatorFn</h4>
    <md-divider></md-divider>
    <md-tab-group md-stretch-tabs>
      <md-tab>
        <ng-template md-tab-label>Demo</ng-template>
        <td-dynamic-forms [elements]="customValidationValidatorFn">
        </td-dynamic-forms>
      </md-tab>
      <md-tab>
        <ng-template md-tab-label>Code</ng-template>
        <p>HTML:</p>
        <td-highlight lang="html">
          <![CDATA[
            <td-dynamic-forms [elements]="customValidationValidatorFn">
            </td-dynamic-forms>
          ]]>
        </td-highlight>
        <p>Typescript:</p>
        <td-highlight lang="typescript">
          <![CDATA[
              // Custom Validator using ValidatorFn function
              customValidationValidatorFn: ITdDynamicElementConfig[] = [{
                name: 'numberIsOddInRange',
                label: 'Odd Number In Range',
                type: TdDynamicType.Number,
                min: 8,
                max: 20,
                customValidators: [

                  // Function using ValidatorFn signature
                  <ValidatorFn>(control: AbstractControl): { [key: string]: any } => {

                    // Validate Logic
                    let isOdd: boolean = ( control.value % 2 ) !== 0;

                    // ITdCustomError Object
                    let error: ITdCustomError = {

                      // Must be unique
                      'isOdd': {

                        // Dynamic error message presented to UI
                        message: 'Not Odd: ' + control.value, 
                      },
                    };

                    return !isOdd ? error : undefined;
                  },
                ],
              }];
            ]]>
        </td-highlight>
      </md-tab>
    </md-tab-group>

    <h4>Multiple Validators</h4>
    <md-divider></md-divider>
    <md-tab-group md-stretch-tabs>
      <md-tab>
        <ng-template md-tab-label>Demo</ng-template>
        <td-dynamic-forms #customValidateForm [elements]="multipleValidatorTypes">
        </td-dynamic-forms>
      </md-tab>
      <md-tab>
        <ng-template md-tab-label>Code</ng-template>
        <p>HTML:</p>
        <td-highlight lang="html">
          <![CDATA[
            <td-dynamic-forms [elements]="multipleValidatorTypes">
            </td-dynamic-forms>
          ]]>
        </td-highlight>
        <p>Typescript:</p>
        <td-highlight lang="typescript">
          <![CDATA[
              // Custom validator with different methods
              multipleValidatorTypes: ITdDynamicElementConfig[] = [{
                name: 'containValidCharacters',
                label: 'Password',
                type: TdDynamicElement.Password,
                required: true,

                // Covalent validator migrated from other project
                tdContainsUppercaseCharacter: true,
                
                customValidators: [

                  // Contain at lease one number
                  <ITdCustomValidate>{
                    name: 'containsNumber',
                    message: 'Need a number',
                    predicateFn: (value: any): boolean => {
                      return /\d/i.test(value); // Return true if valid
                    },
                  },

                  // Length between 8 - 20 characters
                  <ITdCustomValidate>{
                    name: 'length',
                    message: 'Password needs from 8 - 20 characters',
                    predicateFn: (value: any): boolean => {
                      return value && ( value.length >= 8 ) && ( value.length <= 20 ); // Return true if valid
                    },
                  },

                  // Contain at least one special character
                  <ValidatorFn>(control: AbstractControl): { [key: string]: any } => {

                    let validCharacters: string[] = ['!', '@', '#', '$', '%'];
                    let regex: RegExp = new RegExp('[' + validCharacters.join('').toString() + ']', 'g');
                    
                    let isValid: boolean = regex.test(control.value);

                    let error: ITdCustomError = {
                      'containSpecialCharacters': {

                        // TODO: parenthesis may be mistaken for valid special character. refine error message.
                        message: 'Need at least one special character (' + validCharacters.join(', ').toString() + ')',
                      },
                    };

                    return !isValid ? error : undefined;
                  },
                ],
              }];
            ]]>
        </td-highlight>
      </md-tab>
    </md-tab-group>
  </md-card-content>
</md-card>

<md-card>
  <md-card-title>TdDynamicFormsComponent</md-card-title>
  <md-card-subtitle>How to use this component</md-card-subtitle>
  <md-divider></md-divider>
  <md-card-content>
    <h2><code><![CDATA[<td-dynamic-forms>]]></code></h2>
    <p>Use <code><![CDATA[<td-dynamic-forms>]]></code> element to generate a form dynamically.</p>
    <p>Pass an array of javascript objects that implement [ITdDynamicElementConfig] with the information to be rendered to the [elements] attribute.</p>
    <td-highlight lang="typescript">
      <![CDATA[
        export interface ITdDynamicElementConfig {
          label?: string;
          name: string;
          type: TdDynamicType | TdDynamicElement;
          required?: boolean;
          min?: any;
          max?: any;
          default?: any;
        }
      ]]>
    </td-highlight>    
    <h3>Properties:</h3>
    <p>The <code><![CDATA[<td-dynamic-forms>]]></code> component has {{dynamicFormsAttrs.length}} properties:</p>
    <md-list>
      <ng-template let-attr let-last="attr" ngFor [ngForOf]="dynamicFormsAttrs">
        <a md-list-item layout-align="row">
          <h3 md-line> {{attr.name}}: <span>{{attr.type}}</span></h3>
          <p md-line> {{attr.description}} </p>
        </a>
        <md-divider *ngIf="!last"></md-divider>
      </ng-template>
    </md-list>
    <h3>Example:</h3>
    <p>HTML:</p>
    <td-highlight lang="html">
      <![CDATA[
        <td-dynamic-forms [elements]="elements">
        </td-dynamic-forms>
      ]]>
    </td-highlight>
    <p>Typescript:</p>
    <td-highlight lang="typescript">
      <![CDATA[
        import { ITdDynamicElementConfig, TdDynamicElement, TdDynamicType } from '@covalent/dynamic-forms';
        ...
        })
        export class Demo {
          elements: ITdDynamicElementConfig[] = [{
            name: 'input-without-label',
            type: TdDynamicElement.Input,
            required: false,
          }, {
            name: 'input-with-label',
            label: 'Input Label',
            type: TdDynamicElement.Input,
            required: true,
          }, {
            name: 'text-with-default',
            type: TdDynamicType.Text,
            required: false,
            default: 'Default',
          }];
        }
      ]]>
    </td-highlight>
    <h3>Setup:</h3>
    <p>Import the [CovalentDynamicFormsModule] in your NgModule:</p>
    <td-highlight lang="typescript">
      <![CDATA[
        import { CovalentDynamicFormsModule } from '@covalent/dynamic-forms';
        @NgModule({
          imports: [
            CovalentDynamicFormsModule,
            ...
          ],
          ...
        })
        export class MyModule {}
      ]]>
    </td-highlight>
  </md-card-content>
</md-card>